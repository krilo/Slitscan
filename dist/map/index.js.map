{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/js/index.js","src/js/slitscan/SlitscanApp.js"],"names":[],"mappings":"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","file":"index.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","'use strict'\n\nimport SlitscanApp from './slitscan/SlitscanApp';\n\n(function(){\n  const App = new SlitscanApp({el: document.querySelector('#app')})\n})()\n","class SlitscanApp {\n  constructor(options){\n    this.el = options.el;\n\n    // Add Events\n    this.initScene()\n    this.resize()\n\n  }\n\n  initScene(){\n\n    this.camera = new THREE.Camera( )\n    this.camera.position.z = 1\n    this.scene = new THREE.Scene();\n\n    // Buffer\n    let buffers = []\n    let currentBuffer = 0;\n    let numBuffers = 4;\n    let bufferContainer = document.querySelector('.buffers-container')\n    let bufferWidth = 512\n    let bufferHeight = 512\n\n    const getTexture = (canvas) => {\n      let image = new Image();\n      image.src = canvas.toDataURL('image/png');\n      let texture = new THREE.Texture();\n      texture.image = image;\n      texture.magFilter = THREE.LinearFilter;\n      texture.minFilter = THREE.LinearFilter;\n\n      image.onload = () => {\n        texture.needsUpdate = true;\n      };\n\n      return texture\n    }\n\n    let addedGradient = false\n    const getMask = (start, stop) => {\n      let canvas = document.querySelector('#mask') || document.createElement('canvas')\n      canvas.setAttribute('id', 'mask')\n      canvas.width = bufferWidth\n      canvas.height = bufferHeight\n      let ctx = canvas.getContext('2d')\n\n      let grad= ctx.createLinearGradient(0, 0, bufferWidth, bufferHeight);\n      grad.addColorStop(start, \"#000\");\n      grad.addColorStop(stop, \"#FFF\");\n\n      ctx.fillStyle = grad;\n      ctx.fillRect(0, 0, bufferWidth, bufferHeight)\n      if(!addedGradient){\n        addedGradient = true;\n        bufferContainer.appendChild(canvas)\n      }\n      return canvas;\n    }\n\n    /**\n     * Create Buffers\n     */\n\n    let bufferCanvas = document.createElement('canvas')\n    bufferCanvas.width = bufferWidth\n    bufferCanvas.height = bufferHeight\n    let bufferCtx = bufferCanvas.getContext('2d')\n    let buffersPerRow = 2; //Math.ceil(bufferWidth/numBuffers);\n    let numRow = 0;\n    let numCol = 0;\n\n    for (var i = 0; i < numBuffers; i++) {\n      //bufferCtx.fillStyle = `rgb(${Math.floor(255-(255/numBuffers)*i)}, ${Math.floor(255-(255/numBuffers)*i)}, 255)`;\n      let grad= bufferCtx.createLinearGradient(0, 0, bufferWidth, 0);\n      grad.addColorStop(0, `rgb(${Math.round(Math.random()*255)}, ${Math.round(Math.random()*255)}, ${Math.round(Math.random()*255)})`);\n      grad.addColorStop(1, `rgb(${Math.round(Math.random()*255)}, ${Math.round(Math.random()*255)}, ${Math.round(Math.random()*255)})`);\n      bufferCtx.fillStyle = grad;\n\n      let x = Math.floor((bufferWidth/buffersPerRow)*numCol);\n      let y = Math.floor((bufferHeight/buffersPerRow)*numRow);\n\n      if(numCol == buffersPerRow-1){\n        numRow++;\n        numCol = 0;\n      }else {\n        numCol++;\n      }\n      bufferCtx.fillRect(x, y, bufferWidth/buffersPerRow, bufferHeight/buffersPerRow)\n      bufferContainer.appendChild(bufferCanvas)\n    }\n\n    /**\n     * Create Mask\n     */\n    let maskIndex = 0;\n    let maskCanvas = getMask(0,1)\n\n    this.renderer = new THREE.WebGLRenderer( { alpha: true, antialias: true })\n    this.renderer.sortObjects = false;\n\n    this.renderer.setPixelRatio(window.devicePixelRatio)\n    this.renderer.setSize( 800, 600 );\n    this.el.appendChild(this.renderer.domElement)\n\n    let bufferArray = []\n    for (var i = 0; i < buffers.length; i++) {\n      bufferArray[i] = getTexture(buffers[i])\n    }\n\n    /*marioSpriteInfos: {\n        size: new Vec2(256,192),\n        tileSize: new Vec2(32,64)\n      },*/\n    let geometry = new THREE.PlaneBufferGeometry(2, 2)\n    let uniforms = {\n      time:             { type: \"f\", value: 1.0 },\n      resolution:       { type: \"v2\", value: new THREE.Vector2(800, 600) },\n      mask:             { type: \"t\", value: getTexture(maskCanvas)},\n      numBuffers:       { type: \"f\", value: numBuffers},\n      buffer:           { type: \"t\", value: getTexture(bufferCanvas)},\n      buffersPerRow:    { type: \"f\", value: buffersPerRow},\n      spriteSize:       { type: \"v2\", value: new THREE.Vector2(bufferWidth, bufferWidth) },\n      tileSize:         { type: \"v2\", value: new THREE.Vector2(bufferWidth/buffersPerRow, bufferHeight/buffersPerRow) }\n    }\n\n    let vertexShader = `\n      void main()\t{\n        gl_Position = vec4( position, 1.0 );\n      }`;\n\n    let fragmentShader = `\n      uniform float time;\n      uniform float numBuffers;\n      uniform vec2 resolution;\n      uniform float buffersPerRow;\n\n      uniform sampler2D mask;\n      uniform sampler2D buffer;\n\n      uniform vec2 spriteSize;\n      uniform vec2 tileSize;\n\n      // Spritesheets\n      vec4 drawSprite (vec2 p) {\n        ivec2 tile = ivec2(1, 1);\n        \n        vec2 absP = p*resolution.xy;\n        vec2 tileRatio = tileSize/spriteSize;\n        vec2 tilePosition = vec2(tile)*tileRatio;\n        return texture2D(buffer, p*tileRatio+tilePosition);\n      }\n\n      vec4 drawPixel (vec2 p) {\n        vec4 maskPixel = texture2D(mask, p);\n        float brightness = distance(maskPixel, vec4(0.0, 0.0, 0.0, 1.0));\n        float arrayIndex = floor((brightness/2.)*numBuffers);\n\n        vec2 spritePos = p;\n        vec4 bufferPixel = texture2D(buffer,  spritePos);\n\n\n        return bufferPixel;\n      }\n\n      void main() {\n        vec2 p = ( gl_FragCoord.xy / resolution.xy );\n        gl_FragColor = drawSprite(p);\n      }`;\n\n    let material = new THREE.ShaderMaterial( {\n      uniforms: uniforms,\n      vertexShader: vertexShader,\n      fragmentShader: fragmentShader\n    });\n\n    let mesh = new THREE.Mesh(geometry, material)\n    this.scene.add(mesh)\n\n    const render = () => {\n\n      maskIndex++;\n      if(maskIndex > 100){\n        maskIndex = 0;\n      }\n      maskCanvas = getMask(maskIndex/100,1)\n      let maskTexture = getTexture(maskCanvas);\n      maskTexture.needsUpdate = true\n\n      uniforms.time.value += 0.005;\n      uniforms.mask.value = maskTexture\n\n      this.renderer.render( this.scene, this.camera );\n      requestAnimationFrame( render.bind(this) );\n    }\n\n    render()\n  }\n\n\n  resize(){\n    //this.el.width = window.innerWidth;\n    //this.el.height = window.innerHeight;\n    //this.renderer.setSize( this.el.offsetWidth, this.el.offsetHeight );\n  }\n}\n\nmodule.exports = SlitscanApp;\n"]}